<script>
   // ********************************* [ Importar contactos de api externa ]*******************************
  function importarContactos(){
    limpiar()
    google.script.run
      .withSuccessHandler(contactoImportadoOk)
      .withFailureHandler(contactoImportadoError)
      .importarContactos();
  }

  function contactoImportadoOk() {
    crearNotificacionContacto("Contactos importados correctamente", "OK");
    mostrar();
  }

  function contactoImportadoError() {
    crearNotificacionContacto("No se pudieron importar los contactos", "ERROR");
    mostrar();
  }

  function importarContactos(){
  let url = "https://randomuser.me/api/?results=5&nat=es&inc=name,email,phone,picture";
  let respuesta = UrlFetchApp.fetch(url).getContentText();
  let datos = JSON.parse(respuesta);
  datos.results.forEach(contacto => insertarContactoImportado(contacto));
}

function insertarContactoImportado(contacto){
  let nombre = contacto.name.first;
  let apellido = contacto.name.last;
  let correo = contacto.email;
  let telefono = contacto.phone;
  let fotografia = contacto.picture.large;

  insertarContacto(nombre,apellido,correo,telefono,fotografia);
}
</script>
